jQuery("html").addClass("mc-js");var resizeFunction=null;var closeFunction=null;function onClose(a,d,c,b){a("#p1 .contentsbox_internal_open").animate({left:d+"em"},200).end();a("#p1 .contentsbox_wrap").animate({width:c,height:b,top:0},200);a("#p1 .contentsbox_internal").animate({left:"0em"},20);a(document).unbind("click",closeFunction);return false}jQuery(function(a){a("#UserEmail").focus();var i=-20,k=0,c=0,b=0;var m=a("#pS ul.jT");var g=m.length>0;var f=(a("#pC").hasClass("jN")==false)&&a("#pC").find("*").length>0;var l=a("#p1");if(f&&g&&l.length>0){l.prepend('<div class="contentsbox"><div class="contentsbox_wrap"><div class="contentsbox_internal"><img title="Expand table of contents" alt="Contents" src="images/t_contents.gif" /></div><div id="sC" class="contentsbox_internal_open"><div class="ne"><div class="n"></div></div><div class="e"><div class="box"><div class="box_wrapper"><div class="box_wrapper_inner" style="overflow-y: auto; overflow-x: hidden"><ul style="list-style: none; padding-left: 0; margin-left: 1em; margin-top: 0em; margin-bottom: 0em; padding-top: 1em; padding-bottom: 1em;"></ul></div></div><div style="padding-right:8px;font-size:10px; position: absolute; top: 14px; right: 10px;"><a href="#" tyle="float: right; display: block"class="mc-contentsbox-close">CLOSE</a></div></div></div><div class="se"><div class="s"></div></div></div></div></div>').find(".contentsbox_internal_open").css({top:0,left:i+"em"}).end();var d=l.find(".contentsbox");d.click(function(o){o.stopPropagation();return true});closeFunction=function(o){return onClose(a,i,c,b)};l.find("a.mc-contentsbox-close").click(closeFunction);var h=m.find(">li").clone().remove("div").removeAttr("id");l.find(".box_wrapper_inner>ul").append(h);var n=d.offset().top;var j=function(){var v=a(window).height();var u=a(window).scrollTop();var o=a(".contentsbox");var q=150;var r=n-u;var p=q+r;var s=a("#pH").offset().top-u;if(p>v){var t=v-q;if(t<s){t=s}o.css("top",t+"px")}return false};j();a(window).resize(j);var e=l.find(".contentsbox_internal");c=e.outerWidth();b=e.outerHeight();e.bind("click",function(){var o=a(".box_wrapper_inner");var r=a(".contentsbox_internal_open");var u=r.outerWidth();var t=r.outerHeight();var p=t-o.height();var x=a(window).height();var v=a(window).scrollTop();if(t>x){t=x;if(t>p){o.height(t-p)}}var s=t+r.offset().top-v;var w=0;if(s>x){var q=(s-x);if(r.offset().top!=0){w=-q}}a("#p1 .contentsbox_wrap").animate({width:u,height:t,top:w},300);a("#p1 .contentsbox_internal").animate({left:i},300);a(".contentsbox_internal_open").animate({left:0},300);a(document).bind("click",closeFunction);return false})}});var treePlus="./images/plus.gif";var treeMinus="./images/minus.gif";var treeDot="./images/dot.gif";function treeToggle(a,c){var e=c.find(">div>ul");var b=c.find(">div>img");var d=e.length==0;if(d){c.find(">div").eq(1).append('<ul style="display: none"><li>Loading...</li></ul>');e=c.find(">div>ul")}if(e.css("display")=="none"){b.attr("src",treeMinus);e.slideDown("fast");if(d){var f="contents/"+c.attr("id").substring(1)+".xml";a.get(f,null,function(g){treeLoad(a,e,g,"xml")})}}else{b.attr("src",treePlus);e.slideUp("fast")}}function treeLoad(a,d,c){d.find(">li").remove();var b=a(c).children("treefragment").children("node");b.each(function(){renderTree(a,a(this),d)})}function renderTree(a,k,m){var f=k.attr("id");var d=a(k).children("node");var i=d.length>0;var e=k.attr("next")||i;var g=e?treePlus:treeDot;var b=e?"+":"*";m.append('<li id="_'+f+'"><div style="margin: 0; float: left; width: auto;"><img src="'+g+'" alt="'+b+'"/></div><div style="margin: 0 0 0 20px"><a href="'+k.attr("href")+'" title="'+k.attr("text")+'">'+k.attr("text")+"</a></div></li>");var j=m.find("#_"+f);var c=k.attr("autoExpand");if(i>0){j.find("div:last").append('<ul style="display: none"></ul>');var l=j.find("ul");d.each(function(){renderTree(a,a(this),l)})}if(e){var h=j.find(">div>img");h.click(function(n){treeToggle(a,j)});if(c){h.trigger("click")}}}function drawTree(a,d){var b=d.attr("id");var h=d.children("ul");if(b||h.length>0){var c=h.css("display")=="block";var g=c?treeMinus:treePlus;var e=h.children("li").filter(":not(.jN)");d.wrapInner('<div style="margin: 0 0 0 20px;"></div>');d.prepend('<div style="margin: 0; float: left; width: auto;"><img src="'+g+'" alt="+"/></div>');var f=d.find("img").first();if(c||e.length==0){e.each(function(){drawTree(a,a(this))});f.click(function(){treeToggle(a,d)})}else{f.click(function(){if(c==false){e.each(function(){drawTree(a,a(this))});c=true}treeToggle(a,d)})}}else{d.wrapInner('<div style="margin: 0 0 0 20px;"></div>');d.prepend('<div style="margin: 0; float: left; width: auto;"><img src="'+treeDot+'" alt="*"/></div>')}}jQuery(function(a){var b=a(".jT>li").filter(":not(.jN)");b.each(function(){drawTree(a,a(this))})});jQuery(function(a){var e=null,f=0,g=0,i=a(".jM li");i.hover(function(){a(this).toggleClass("hover")});var b=i.find(".jA");b.click(function(){if(e!=null){e.css("visibility","hidden");e.css("overflow",g);e.height(f);e=null}else{var l=a(this).parent();e=l.find("ul");f=e.height();var n=l.width();var m=a(e).find("li>a");m.each(function(){if(a(this).width()>n){n=a(this).width()}});m.each(function(){if(a(this).width()<n){a(this).width(n)}});e.css("visibility","visible");var o=a(window).scrollTop();var k=a(window).height();var j=(e.offset().top-o)+f;if(j>k){g=e.css("overflow");e.css("overflow","auto");e.height(e.height()-(j-k))}l.hover(function(){var p=a(this).data("timeout");clearTimeout(p)},function(){var p=a(this).data("timeout");clearTimeout(p);p=setTimeout(function(){if(e){e.css("visibility","hidden");e.css("overflow",g);e.height(f);e=null}},500);a(this).data("timeout",p)})}return false});var h=a("#publicationList li");var c=a("#description");var d=c.html();h.hover(function(){var j=a(this).find("a").attr("title");c.text(j)},function(){c.html(d)})});function makeTooltip(g){var b=g.attr("class").split(" ");var a=new Array();var c="<ul>";for(var d=0;d<b.length;++d){var e=b[d];if(e!="tooltip"){var f=document.getElementById(e);if(f){a.push(f);c+="<li>"+f.innerHTML+"</li>"}}}c+="</ul>";return c}jQuery(function(a){var b=a(".tooltip");b.tooltip({bodyHandler:function(){var c=makeTooltip(a(this));return c},showURL:false,fade:200})});jQuery(function(a){var c=["url(./images/p_homepage4.jpg)","url(./images/p_homepage3.jpg)","url(./images/p_homepage2.jpg)","url(./images/p_homepage.jpg)"];var d=0;var b=0;a(".featuremenu a").hover(function(){var g=a(this).data("timeout");clearTimeout(g);var f=a(".featuremenu a").index(this);var e=c[f];g=setTimeout(function(){d=f;if(b==0){a("#feature .v").css("background-image",e);a("#animation").animate({opacity:0},300);b=1}else{a("#animation").css("background-image",e);a("#animation").animate({opacity:1},300);b=0}a(".featurette_top").hide().eq(f).show()},250);a(this).data("timeout",g)},function(){var e=a(this).data("timeout");clearTimeout(e)})});$.ga=function(a){var b=(("https:"==document.location.protocol)?"https://ssl.":"http://www.");var c=b+"google-analytics.com/ga.js";$.ajax({type:"GET",url:c,success:function(){try{pageTracker=_gat._getTracker(a);pageTracker._trackPageview()}catch(d){}},error:function(){},dataType:"script",cache:true})};var ddsmoothmenu={transition:{overtime:300,outtime:300},showhidedelay:{showdelay:100,hidedelay:200},detectwebkit:navigator.userAgent.toLowerCase().indexOf("applewebkit")!=-1,detectie6:(document.all&&!window.XMLHttpRequest)?true:false,css3support:window.msPerformance||(!document.all&&document.querySelector),ismobile:navigator.userAgent.match(/(iPad)|(iPhone)|(iPod)|(android)|(webOS)/i)!=null,buildmenu:function(a,d){var e=ddsmoothmenu;var c=a("."+d.classname+">ul");var b=c.find("ul").parent("li");b.each(function(j){var f=a(this).css({zIndex:100});var g=a(this).find("ul:eq(0)").css({display:"block"});g.data("timers",{});this._dimensions={w:this.offsetWidth,h:this.offsetHeight,subulw:g.outerWidth(),subulh:g.outerHeight()};this.istopheader=f.parents("ul").length==1?true:false;g.css({top:this.istopheader&&d.orientation!="v"?this._dimensions.h+"px":0});var h=f.children("a:eq(0)").html();f.children("a").replaceWith("<span>"+h+"</span>");f.children("span:eq(0)").addClass("dropdown").append(" &#9660;");f.click(function(i){i.stopPropagation();if(a(this).children("a, span").hasClass("selected")){hideMenu(f,g)}else{clearMenus(a);showMenu(a,f,g)}});if(ddsmoothmenu.ismobile){f.on("touchstart",function(i){i.stopPropagation()})}});c.find("ul").css({display:"none",visibility:"visible"})},init:function(a,b){a("#vM>ul").append('<li id="opts"><span>Settings</span><ul></ul></li>');ddsmoothmenu.buildmenu(a,b)}};function hideMenu(a,b){clearTimeout(b.data("timers").showtimer);b.data("timers").hidetimer=setTimeout(function(){b.animate({height:"hide",opacity:"hide"},ddsmoothmenu.transition.outtime)},ddsmoothmenu.showhidedelay.hidedelay);a.children("a, span").removeClass("selected")}function showMenu(a,b,c){var d=b.get(0);clearTimeout(c.data("timers").hidetimer);c.data("timers").showtimer=setTimeout(function(){d._offsets={left:b.offset().left,top:b.offset().top};var e=d.istopheader?0:d._dimensions.w-1;e=(d._offsets.left+e+d._dimensions.subulw>a(window).width())?(d.istopheader&&setting.orientation!="v"?-d._dimensions.subulw+d._dimensions.w:-d._dimensions.w):e;if(c.queue().length<=1){c.animate({height:"show",opacity:"show"},ddsmoothmenu.transition.overtime)}},ddsmoothmenu.showhidedelay.showdelay);b.children("a, span").addClass("selected")}function clearMenus(a){a(".menu>ul").find("ul").parent("li").each(function(b){hideMenu(a(this),a(this).find("ul:eq(0)"))})}function bindSearchClick(a,c,b){a("#"+b).click(function(d){a("#pub-list>ul>li>span:eq(0)").html(a(this).html()+" &#9660;");var f=a("#start-search").outerWidth()-a("#pub-list").outerWidth();a("#input-box, #input-box input").css("width",f-4);a("#searchForm").attr("action",c)})}function compare(c,d){return(c.firstChild.nodeValue>d.firstChild.nodeValue?1:-1)}function selectionValidate(){var a=$('input[name="__target_buy"]');if(!$("#agree").attr("checked")||$('#pricetable input[type="checkbox"][id != "agree"]:checked').length==0||!$('select[name="country"]').children("option:selected").val()){a.attr("disabled","disabled")}else{a.removeAttr("disabled")}}function XMLtoHTML(a){if($.browser.msie){var b="",c=a.children();if(window.ActiveXObject){c.each(function(d){b+=c[d].xml})}return b}else{return a.html()}}function nodeValue(a){return a.text||a.textContent}jQuery(document).ready(function(a){ddsmoothmenu.init(a,{mainmenuid:"vM",orientation:"h",classname:"menu",contentsource:"markup"});var e=(a.cookie("pin")==="yes");var c=87;a(window).load(function(g){if(e&&!ddsmoothmenu.detectie6&&!ddsmoothmenu.ismobile){a("#hC").addClass("pinned");a("#pH").css("margin-top",c)}if(!ddsmoothmenu.detectie6&&!ddsmoothmenu.ismobile){a("#opts>ul").append('<li><span id="pin-header">Header is '+(e?"floating":"attached")+"</span></li>");a("#pin-header").click(function(h){h.stopPropagation();a("#hC").toggleClass("pinned");var i=a("#hC").hasClass("pinned");a("#pH").css("margin-top",i?c:0);a(this).html("Header is "+(i?"floating":"attached"));if(a("#hC").hasClass("pinned")){a.cookie("pin","yes",{path:"/"})}else{a.cookie("pin","no",{path:"/"})}})}if(ddsmoothmenu.detectie6){a("#account-info>span, #opts>span, div.menu>ul>li>ul>li>span").hover(function(h){a(this).toggleClass("hover")})}});a(window).resize(function(g){if(this.outerWidth<43*parseInt(a("#start-search").css("font-size"),10)+60){a("#start-search").css("width",(this.outerWidth-60>0)?this.outerWidth-60:0)}else{a("#start-search").css("width","")}var h=a("#start-search").outerWidth()-a("#pub-list").outerWidth()-4;a("#input-box").css("width",h+"px")});var f=a("#start-search").outerWidth()-a("#pub-list").outerWidth()-4;a("#input-box").css("width",f+"px");a("body").click(function(g){clearMenus(a)});if(ddsmoothmenu.ismobile){a("body").on("touchstart",function(g){clearMenus(a)})}if(a("#agree").length>0){selectionValidate();a("#agree").change(function(g){selectionValidate()});a('#calculate_price input[type="checkbox"]').change(function(h){var g={country:a('select[name="country"]').children("option:selected").val()};a("#calculate_price input:checked").each(function(j){g[this.name]="on"});a.ajax({type:"post",url:"/mc/pricetable.htm",data:g,cache:false,success:function(i){a("#pricetable tr.pricetotal").remove();a("#pricetable tbody").append(XMLtoHTML(a(i).find("total")));selectionValidate()}})});a('select[name="country"]').change(function(h){var g={country:a(this).children("option:selected").val()};a("#calculate_price input:checked").each(function(j){g[this.name]="on"});a.ajax({type:"post",url:"/mc/pricetable.htm",data:g,cache:false,success:function(j){var i=a(j).find("currency");var k=a(j).find("price");a("#pricetable th:eq(1)").html("Price ("+nodeValue(i[0])+")");a("#pricetable tr:gt(0):not(.pricetotal)").each(function(l){a(this).children("td:eq(2)").html(nodeValue(k[l]))});a("#pricetable tr.pricetotal").remove();a("#pricetable tbody").append(XMLtoHTML(a(j).find("total")));selectionValidate()}})});a('input[name="__target_calculate_price"]').css("display","none");var d=a("#mp-discounts").outerHeight(),b=a("#mp-discounts");b.addClass("collapsed");b.css("height","2.5em");a("#mp-discounts h3").html("Show multi-publication discount details");a("#mp-discounts h3").click(function(g){if(b.hasClass("collapsed")){b.animate({height:d},300);b.children("h3").html("Hide multi-publication discount details")}else{b.animate({height:"2.5em"},300);b.children("h3").html("Show multi-publication discount details")}b.toggleClass("collapsed")})}if(a("#pub-list").length>0){a.get("/mc/pubs.xml",function(g){var m=g.getElementsByTagName("publication");var n=[];for(var j=m.length;j--;n.unshift(m[j])){}n.sort(compare);try{a("#pub-list>ul>li>ul").append('<li><span id="mc">All Publications</span></li>');if(a('link[rel="start"]').length>0){bindSearchClick(a,"./global.htm","mc")}else{bindSearchClick(a,"./search.htm","mc")}for(var j in n){var l=n[j].getAttribute("path");var k=l.substring(1,l.indexOf("/",1));a("#pub-list>ul>li>ul").append('<li><span id="'+k+'">'+n[j].firstChild.nodeValue+"</span></li>");bindSearchClick(a,"/mc"+l+"search.htm",k)}}catch(h){}})}});(function(a){var e={},c,l,k,g=a.browser.msie&&/MSIE\s(5\.5|6\.)/.test(navigator.userAgent),m=false;a.tooltip={blocked:false,defaults:{delay:200,fade:false,showURL:true,extraClass:"",top:15,left:15,id:"tooltip"},block:function(){a.tooltip.blocked=!a.tooltip.blocked}};a.fn.extend({tooltip:function(p){p=a.extend({},a.tooltip.defaults,p);b(p);return this.each(function(){a.data(this,"tooltip",p);this.tOpacity=e.parent.css("opacity");this.tooltipText=this.title;a(this).removeAttr("title");this.alt=""}).mouseover(h).mouseout(f).click(f)},fixPNG:g?function(){return this.each(function(){var p=a(this).css("backgroundImage");if(p.match(/^url\(["']?(.*\.png)["']?\)$/i)){p=RegExp.$1;a(this).css({backgroundImage:"none",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=crop, src='"+p+"')"}).each(function(){var q=a(this).css("position");if(q!="absolute"&&q!="relative"){a(this).css("position","relative")}})}})}:function(){return this},unfixPNG:g?function(){return this.each(function(){a(this).css({filter:"",backgroundImage:""})})}:function(){return this},hideWhenEmpty:function(){return this.each(function(){a(this)[a(this).html()?"show":"hide"]()})},url:function(){return this.attr("href")||this.attr("src")}});function b(p){if(e.parent){return}e.parent=a('<div id="'+p.id+'"><h3></h3><div class="body"></div><div class="url"></div></div>').appendTo(document.body).hide();if(a.fn.bgiframe){e.parent.bgiframe()}e.title=a("h3",e.parent);e.body=a("div.body",e.parent);e.url=a("div.url",e.parent)}function i(p){return a.data(p,"tooltip")}function d(p){if(i(this).delay){k=setTimeout(j,i(this).delay)}else{j()}m=!!i(this).track;a(document.body).bind("mousemove",n);n(p)}function h(){if(a.tooltip.blocked||this==c||(!this.tooltipText&&!i(this).bodyHandler)){return}c=this;l=this.tooltipText;if(i(this).bodyHandler){e.title.hide();var p=i(this).bodyHandler.call(this);if(p.nodeType||p.jquery){e.body.empty().append(p)}else{e.body.html(p)}e.body.show()}else{if(i(this).showBody){var s=l.split(i(this).showBody);e.title.html(s.shift()).show();e.body.empty();for(var q=0,r;(r=s[q]);q++){if(q>0){e.body.append("<br/>")}e.body.append(r)}e.body.hideWhenEmpty()}else{e.title.html(l).show();e.body.hide()}}if(i(this).showURL&&a(this).url()){e.url.html(a(this).url().replace("http://","")).show()}else{e.url.hide()}e.parent.addClass(i(this).extraClass);if(i(this).fixPNG){e.parent.fixPNG()}d.apply(this,arguments)}function j(){k=null;if((!g||!a.fn.bgiframe)&&i(c).fade){if(e.parent.is(":animated")){e.parent.stop().show().fadeTo(i(c).fade,c.tOpacity)}else{e.parent.is(":visible")?e.parent.fadeTo(i(c).fade,c.tOpacity):e.parent.fadeIn(i(c).fade)}}else{e.parent.show()}n()}function n(p){if(a.tooltip.blocked){return}if(p&&p.target.tagName=="OPTION"){return}if(!m&&e.parent.is(":visible")){a(document.body).unbind("mousemove",n)}if(c==null){a(document.body).unbind("mousemove",n);return}e.parent.removeClass("viewport-right").removeClass("viewport-bottom");var r=e.parent[0].offsetLeft;var t=e.parent[0].offsetTop;if(p){r=p.pageX+i(c).left;t=p.pageY+i(c).top;var s="auto";if(i(c).positionLeft){s=a(window).width()-r;r="auto"}e.parent.css({left:r,right:s,top:t})}var u=o(),q=e.parent[0];if(u.x+u.cx<q.offsetLeft+q.offsetWidth){r-=q.offsetWidth+20+i(c).left;e.parent.css({left:r+"px"}).addClass("viewport-right")}if(u.y+u.cy<q.offsetTop+q.offsetHeight){t-=q.offsetHeight+20+i(c).top;e.parent.css({top:t+"px"}).addClass("viewport-bottom")}}function o(){return{x:a(window).scrollLeft(),y:a(window).scrollTop(),cx:a(window).width(),cy:a(window).height()}}function f(q){if(a.tooltip.blocked){return}if(k){clearTimeout(k)}c=null;var r=i(this);function p(){e.parent.removeClass(r.extraClass).hide().css("opacity","")}if((!g||!a.fn.bgiframe)&&r.fade){if(e.parent.is(":animated")){e.parent.stop().fadeTo(r.fade,0,p)}else{e.parent.stop().fadeOut(r.fade,p)}}else{p()}if(i(this).fixPNG){e.parent.unfixPNG()}}})(jQuery);jQuery.cookie=function(h,m,j){if(typeof m!="undefined"){j=j||{};if(m===null){m="";j.expires=-1}var f="";if(j.expires&&(typeof j.expires=="number"||j.expires.toUTCString)){var d;if(typeof j.expires=="number"){d=new Date();d.setTime(d.getTime()+(j.expires*24*60*60*1000))}else{d=j.expires}f="; expires="+d.toUTCString()}var k=j.path?"; path="+(j.path):"";var e=j.domain?"; domain="+(j.domain):"";var l=j.secure?"; secure":"";document.cookie=[h,"=",encodeURIComponent(m),f,k,e,l].join("")}else{var c=null;if(document.cookie&&document.cookie!=""){var b=document.cookie.split(";");for(var g=0;g<b.length;g++){var a=jQuery.trim(b[g]);if(a.substring(0,h.length+1)==(h+"=")){c=decodeURIComponent(a.substring(h.length+1));break}}}return c}};(function(a){a.fn.autoSuggest=function(g,e){var c={asHtmlID:false,control:null,startText:"",queryParam:"q",extraParams:"",minChars:1,cookieName:"as",keyDelay:200,neverSubmit:false,start:function(){},beforeRetrieve:function(h){return h},retrieveComplete:function(h){return h},resultClick:function(h){},resultsComplete:function(){}};var d={};var f=a.extend(c,e);var b=0;if(typeof g=="string"){return this.each(function(z){if(!f.asHtmlID){z=z+""+Math.floor(Math.random()*100);var A="as-input-"+z}else{z=f.asHtmlID;var A=z}f.start.call(this);var l=a(this);l.attr("autocomplete","off").addClass("as-input").attr("id",A);if(l.val().length==0){l.val(f.startText)}var m=false;var s=a('<div class="as-results" id="as-results-'+z+'"></div>').hide();var t=a('<ul class="as-list"></ul>');var u=a('<input type="text" class="as-shadow" id="as-values-'+z+'" />');u.insertBefore(l);s.insertAfter(l);var j=f.cookieName;var i=a.cookie(j);if(typeof i=="undefined"||i!="true"&&i!="false"){isEnabled=true;a.cookie(j,true,{path:"/"})}else{isEnabled=i=="true"}if(typeof f.control=="string"){var h=a(f.control);if(h){a("#opts>ul").prepend('<li><span id="suggest-switch">Autosuggest is '+(isEnabled?"on":"off")+"</span></li>");a("#suggest-switch").click(function(x){x.stopPropagation();isEnabled=!isEnabled;a(this).html("Autosuggest is "+(isEnabled?"on":"off"));a.cookie(j,isEnabled,{path:"/"})})}}var w=null;var q="";var y=0;var v=false;l.focus(function(){var x=a("#start-search").outerWidth()-a("#pub-list").outerWidth();a("#input-box, #input-box input").css("width",x-4);s.css("width",x);if(a(this).val()==f.startText){a(this).val("")}else{if(m){if(isEnabled==true&&a(this).val()!=""){s.show();u.css("color","#aaa")}}}m=true;return true}).blur(function(){if(m){s.hide()}u.css("color","white")}).keydown(function(x){if(isEnabled==false){return}lastKeyPressCode=x.keyCode;first_focus=false;switch(x.keyCode){case 38:x.preventDefault();o(1);break;case 40:x.preventDefault();o(0);break;case 8:if(l.val().length<=1){s.hide();u.val("");q=""}else{if(w){clearTimeout(w)}w=setTimeout(function(){n()},f.keyDelay)}break;case 9:v=true;s.hide();x.preventDefault();var B=u.val();l.val(B);break;case 13:v=false;s.hide();u.val("");break;case 27:v=false;s.hide();u.val("");break;default:if(w){clearTimeout(w)}w=setTimeout(function(){n()},f.keyDelay);break}});function n(){if(isEnabled==false){return}if(lastKeyPressCode==46||(lastKeyPressCode>8&&lastKeyPressCode<32)){return s.hide()}var C=l.val();var B=l.val().replace(/[\\]+|[\/]+/g,"");if(B==q){return}if(B.search(q)==0&&d[q]&&d[q].d_count==0){return s.hide()}q=B;if(B.length>=f.minChars){var x="";if(f.beforeRetrieve){B=f.beforeRetrieve.call(this,B)}if(d[B]){b=d[B].d_count;r(d[B].data)}else{a.getJSON(g+"?"+f.queryParam+"="+encodeURIComponent(B)+x+f.extraParams,function(E){b=0;var F=f.retrieveComplete.call(this,E);for(k in F){if(F.hasOwnProperty(k)){b++}}d[B]={data:F,d_count:b};var D=l.val().replace(/[\\]+|[\/]+/g,"");if(B==D){r(F)}else{if(d[D]){b=d[D].d_count;r(d[D].data)}}})}}else{s.hide()}}var p=0;function r(x){var D=0;s.html(t.html("")).hide();for(var C=0;C<b;C++){var E=C;p++;var G=x[E];if(C==0){var F=l.val()+G;u.val(F)}var B=a('<li class="as-result-item" id="as-result-item-'+E+'"></li>').click(function(){var K=a(this).data("data");var J=K.num;if(!v){var I=K.attributes;l.val(l.val()+I).focus();u.val(l.val());f.resultClick.call(this,K);s.hide();m=false;a("#searchForm").submit()}v=false}).mousedown(function(){m=false}).mouseover(function(){a("li",t).removeClass("active");a(this).addClass("active")}).data("data",{attributes:x[E],num:p});B=B.html(l.val()+"<em>"+x[E]+"</em>");t.append(B);delete this_data;D++}t.css("display",D<=0?"none":"block");if(D<=0){u.val("");t.css("none");s.hide()}else{s.show();t.css("display","block")}var H=a("#start-search").outerWidth()-a("#pub-list").outerWidth();s.css("width",H+"px");f.resultsComplete.call(this)}function o(B){if(a(":visible",s).length>0){var C=a("li",s);if(B==0){var D=C.eq(0)}else{var D=C.filter(":last")}var x=a("li.active:first",s);if(x.length>0){if(B==0){D=x.next()}else{D=x.prev()}}C.removeClass("active");D.addClass("active");x=a("li.active:first",s);if(x.length==0){o(B);return}var E=x.text();l.val(E);u.val(E)}}})}}})(jQuery);